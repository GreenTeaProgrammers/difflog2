# Backendの現状と課題

## 現状

`go run main.go` が動かない問題は解消され、アプリケーションは正常に起動するようになりました。

### 修正内容
- **データベース接続の修正:**
  - 各コントローラーがデータベース接続を直接参照するのではなく、`main.go` で初期化した接続を渡すようにリファクタリングしました。
- **環境変数の設定:**
  - `backend/.env` ファイルに `DATABASE_DSN` を設定し、アプリケーションがデータベースに接続できるようにしました。
- **データベースコンテナの起動:**
  - `docker compose` を使ってデータベースコンテナを正常に起動しました。
- **データベースマイグレーションエラーの修正:**
  - `models.go` のモデル定義の型を修正し、GORM のマイグレーションが正しく実行されるようにしました。
- **コミット:**
  - 上記の修正内容を `fix: go run main.goが動かない問題を修正` というメッセージでコミットしました。

## 課題

- **`DetectionController` の無効化:**
  - ONNX モデルの読み込みで `cannot decode model: No data found` というエラーが発生するため、現在 `DetectionController` は無効化されています。
  - **原因:** `github.com/owulveryck/onnx-go` ライブラリ (v0.5.0) が、YOLOv8 からエクスポートされた ONNX モデル (opset 11, 12) を正しく解析できていない可能性があります。
  - **今後の対応:**
    1. `github.com/owulveryck/onnx-go` ライブラリを新しいバージョンにアップデートする。
    2. モデルをエクスポートする際の ONNX opset バージョンを、ライブラリがサポートするものに合わせる（例: 9, 10 など）。
    3. それでも解決しない場合は、別の ONNX ライブラリの利用を検討する。
